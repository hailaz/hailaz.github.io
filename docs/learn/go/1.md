---
title: 技巧
---

## gofmt 格式化代码

gofmt -s -w xxx.go

## 嵌套结构体屏蔽指定字段 json 输出

```go
type User struct {
 Pwd string `json:"pwd"`
 Age int    `json:"age"`
}

type UserOut struct {
 User
 Pwd *struct{} `json:"pwd,omitempty"`// 这里的字段json名需要和嵌套的字段json名一致，否则无效
}

func TestJson(t *testing.T) {
 u := User{Pwd: "123", Age: 1}
 bb := UserOut{User: u}
 b, _ := json.MarshalIndent(bb, "", "    ")
 t.Log(string(b))
}
```

## github action 使用 ubuntu-latest 执行 make xxx 操作时，需要在 Makefile 指定 shell

在首行添加

```makefile
SHELL := /bin/bash
```

## go get 指定版本

从 Go 1.11 开始，使用 Go modules 可以做到这一点。在为 Go 模块安装依赖项时，你可以指定一个模块查询，其中可能包含分支或标记名称：

拉取最新的版本(优先择取 tag)

```shell
go get golang.org/x/text@latest
```

拉取 master 分支的最新 commit

```shell
go get golang.org/x/text@master
```

拉取 tag 为 v0.3.2 的 commit

```shell
go get golang.org/x/text@v0.3.2
```

拉取 hash 为 342b231 的 commit，最终会被转换为 v0.3.2：

```shell
go get golang.org/x/text@342b2e
```

指定版本拉取，拉取 v3 版本

```shell
go get github.com/smartwalle/alipay/v3
```
