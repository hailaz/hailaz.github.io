---
layout: post
title: MGR
tags: mysql
categories: learn
---

https://blog.csdn.net/m0_37890289/article/details/80003994
https://dev.mysql.com/downloads/mysql/


mysqld --defaults-file=D:\hailaz\mysql\mysql1\my.ini --initialize --console
mysqld install MySQL1 --defaults-file="D:\hailaz\mysql\mysql1\my.ini"
net start MySQL1

net stop MySQL1
sc delete MySQL1












mysqld --defaults-file=D:\hailaz\mysql\mysql2\my.ini --initialize --console
mysqld install MySQL2 --defaults-file="D:\hailaz\mysql\mysql2\my.ini"
mysqld --defaults-file=D:\hailaz\mysql\mysql3\my.ini --initialize --console
mysqld install MySQL3 --defaults-file="D:\hailaz\mysql\mysql3\my.ini"


mysql -u root -p --protocol=tcp --host=localhost --port=3308（选择端口）
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'newpassword';
flush privileges;



server-id=3
gtid-mode=on
enforce-gtid-consistency=on
master-info-repository=TABLE
relay-log-info-repository=TABLE
binlog-checksum=none
log-slave-updates=on
log-bin=binlog
binlog-format=ROW
 
transaction-write-set-extraction=XXHASH64
loose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'
loose-group_replication_start_on_boot=off
loose-group_replication_local_address='127.0.0.1:33071'
loose-group_replication_group_seeds='127.0.0.1:33071,127.0.0.1:33072,127.0.0.1:33073'
loose-group_replication_bootstrap_group=off
loose-group_replication_single_primary_mode=off
loose-group_replication_enforce_update_everywhere_checks=ON




create user 'repl'@'%' identified with mysql_native_password by 'xiao3.top';
GRANT REPLICATION SLAVE ON *.* TO repl@'%';
flush privileges;
install plugin group_replication soname 'group_replication.dll';
CHANGE MASTER TO MASTER_USER='repl',MASTER_PASSWORD='xiao3.top' FOR CHANNEL 'group_replication_recovery';

其中一台
set persist group_replication_single_primary_mode=off;
SET GLOBAL group_replication_bootstrap_group=ON;
start group_replication;
SET GLOBAL group_replication_bootstrap_group=OFF; 
select * from  performance_schema.replication_group_members;
其它
set persist group_replication_single_primary_mode=off;
START GROUP_REPLICATION;

停止
stop GROUP_REPLICATION;
失败时
reset master;
start group_replication;
select * from performance_schema.replication_group_members;
----------------------------

server-id=1　　//Mysql服务ID
gtid-mode=on　　//全局事务
enforce-gtid-consistency=on　　//强制GTID的一致性
master-info-repository=TABLE　　//将master.info元数据保存在系统表中
relay-log-info-repository=TABLE　　//将relay.info元数据保存在系统表中
binlog-checksum=none　　//禁用二进制日志事件校验
log-slave-updates=on　　//级联复制
log-bin=binlog　　//开启二进制日志记录
binlog-format=ROW　　//以行的格式记录
 
transaction-write-set-extraction=XXHASH64　　//使用哈希算法将其编码为散列
loose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'　　//加入的组名，可以修改，只要格式对
loose-group_replication_start_on_boot=off　　//不自动启用组复制集群
loose-group_replication_local_address='127.0.0.1:33071'　　//以本机端口33061接受来自组中成员的传入连接
loose-group_replication_group_seeds='127.0.0.1:33071,127.0.0.1:33072,127.0.0.1:33073'　　//组中成员访问表
loose-group_replication_bootstrap_group=off　　//不启用引导组
loose-group_replication_single_primary_mode=off　　//关闭单master模式
loose-group_replication_enforce_update_everywhere_checks=ON　　//多主一致性检查
