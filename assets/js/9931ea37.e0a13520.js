"use strict";(self.webpackChunkhailaz_github_io=self.webpackChunkhailaz_github_io||[]).push([[6829],{9230:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>i,default:()=>d,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"learn/mysql/mgr","title":"MGR","description":"mysql\u7684\u5b89\u88c5","source":"@site/docs/learn/mysql/mgr.md","sourceDirName":"learn/mysql","slug":"/learn/mysql/mgr","permalink":"/docs/learn/mysql/mgr","draft":false,"unlisted":false,"editUrl":"https://github.com/hailaz/hailaz.github.io/blob/master/docs/learn/mysql/mgr.md","tags":[{"inline":true,"label":"mysql","permalink":"/docs/tags/mysql"}],"version":"current","frontMatter":{"layout":"post","title":"MGR","tags":["mysql"]},"sidebar":"learn","previous":{"title":"goset","permalink":"/docs/learn/go/\u793a\u4f8b/goset"},"next":{"title":"WebSocket","permalink":"/docs/learn/web/2019-07-15-websocket"}}');var l=o(4848),a=o(8453);const t={layout:"post",title:"MGR",tags:["mysql"]},i=void 0,r={},c=[{value:"mysql\u7684\u5b89\u88c5",id:"mysql\u7684\u5b89\u88c5",level:3},{value:"mysql\u914d\u7f6e\u6587\u4ef6",id:"mysql\u914d\u7f6e\u6587\u4ef6",level:3},{value:"mgr\u51c6\u5907",id:"mgr\u51c6\u5907",level:3},{value:"mgr",id:"mgr",level:3},{value:"install.bat",id:"installbat",level:4},{value:"restart.bat",id:"restartbat",level:4},{value:"uninstall.bat",id:"uninstallbat",level:4},{value:"my.ini",id:"myini",level:4}];function m(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h3,{id:"mysql\u7684\u5b89\u88c5",children:"mysql\u7684\u5b89\u88c5"}),"\n",(0,l.jsxs)(n.p,{children:["\u53c2\u8003\uff1a",(0,l.jsx)(n.a,{href:"https://blog.csdn.net/m0_37890289/article/details/80003994",children:"windows\u540c\u65f6\u5b89\u88c5\u591a\u4e2amysql8.0\u670d\u52a1 - levenx - CSDN\u535a\u5ba2"})]}),"\n",(0,l.jsxs)(n.p,{children:["\u4e0b\u8f7dzip\u7248\u672c\u7684mysql\uff1a",(0,l.jsx)(n.a,{href:"https://dev.mysql.com/downloads/mysql/",children:"MySQL :: Download MySQL Community Server"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'// \u521d\u59cb\u5316\nmysqld --defaults-file=D:\\hailaz\\mysql\\mysql1\\my.ini --initialize --console\n// \u5b89\u88c5\u670d\u52a1\nmysqld install MySQL1 --defaults-file="D:\\hailaz\\mysql\\mysql1\\my.ini"\n\n// \u542f\u52a8\u670d\u52a1\nnet start MySQL1\n// \u505c\u6b62\u670d\u52a1\nnet stop MySQL1\n// \u5220\u9664\u670d\u52a1\nsc delete MySQL1\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u4f7f\u7528install\u811a\u672c\u53ef\u4e00\u952e\u521b\u5efa\u591a\u4e2amysql\u670d\u52a1"}),"\n",(0,l.jsx)(n.h3,{id:"mysql\u914d\u7f6e\u6587\u4ef6",children:"mysql\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ini",children:"server-id=3\ngtid-mode=on\nenforce-gtid-consistency=on\nmaster-info-repository=TABLE\nrelay-log-info-repository=TABLE\nbinlog-checksum=none\nlog-slave-updates=on\nlog-bin=binlog\nbinlog-format=ROW\n \ntransaction-write-set-extraction=XXHASH64\nloose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'\nloose-group_replication_start_on_boot=off\nloose-group_replication_local_address='127.0.0.1:33071'\nloose-group_replication_group_seeds='127.0.0.1:33071,127.0.0.1:33072,127.0.0.1:33073'\nloose-group_replication_bootstrap_group=off\nloose-group_replication_single_primary_mode=off\nloose-group_replication_enforce_update_everywhere_checks=ON\n"})}),"\n",(0,l.jsx)(n.h3,{id:"mgr\u51c6\u5907",children:"mgr\u51c6\u5907"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"create user 'repl'@'%' identified with mysql_native_password by 'xiao3.top';\nGRANT REPLICATION SLAVE ON *.* TO repl@'%';\nflush privileges;\ninstall plugin group_replication soname 'group_replication.dll';\nCHANGE MASTER TO MASTER_USER='repl',MASTER_PASSWORD='xiao3.top' FOR CHANNEL 'group_replication_recovery';\n"})}),"\n",(0,l.jsx)(n.h3,{id:"mgr",children:"mgr"}),"\n",(0,l.jsx)(n.p,{children:"\u5176\u4e2d\u4e00\u53f0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"set persist group_replication_single_primary_mode=off;\nSET GLOBAL group_replication_bootstrap_group=ON;\nstart group_replication;\nSET GLOBAL group_replication_bootstrap_group=OFF; \nselect * from  performance_schema.replication_group_members;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4ece\u673a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"set persist group_replication_single_primary_mode=off;\nSTART GROUP_REPLICATION;\nselect * from performance_schema.replication_group_members;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u505c\u6b62"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"stop GROUP_REPLICATION;\nselect * from performance_schema.replication_group_members;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5931\u8d25\u65f6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mysql",children:"reset master;\nstart group_replication;\nselect * from performance_schema.replication_group_members;\n"})}),"\n",(0,l.jsx)(n.h4,{id:"installbat",children:"install.bat"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:'::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 "%SYSTEMROOT%\\system32\\cacls.exe" "%SYSTEMROOT%\\system32\\config\\system"\nif \'%errorlevel%\' EQU \'0\' (\n\tgoto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n\tgoto end\n)\n\n:main\nset basePath=%cd%\nset sourcePath=%basePath%\\mysql\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n\necho !cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\n\nxcopy %sourcePath% !cMySQLPath! /S /E /Y /D\n\necho \u8fdb\u5165\u76ee\u5f55!cMySQLPath!\ncd !cMySQLPath!\n\n\nif not exist !cMySQLPath!\\data (\necho data\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u521b\u5efadata\u76ee\u5f55\nmd !cMySQLPath!\\data\n)\n\nif not exist !cMySQLPath!\\log (\necho log\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u521b\u5efalog\u76ee\u5f55\nmd !cMySQLPath!\\log\n)\necho \u751f\u6210\u914d\u7f6e\u6587\u4ef6\n\necho #auto creat> my.ini\necho [mysql]>> my.ini\necho default-character-set=utf8>> my.ini\necho [mysqld]>> my.ini\necho port = 3306%%i>> my.ini\necho basedir=!cMySQLPath!>> my.ini\necho datadir=!cMySQLPath!\\data>> my.ini\necho sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES>> my.ini\necho character-set-server = utf8mb4>> my.ini\necho performance_schema_max_table_instances = 600>> my.ini\necho table_definition_cache = 400>> my.ini\necho table_open_cache = 256>> my.ini\necho log-error=!cMySQLPath!\\log\\log-error.txt>> my.ini\n\necho \u5b89\u88c5\u670d\u52a1\ncd !cMySQLPath!\\bin\nmysqld --defaults-file=!cMySQLPath!\\my.ini --initialize --console\nmysqld install !cMySQLName! --defaults-file="!cMySQLPath!\\my.ini"\n\n)\n\n)\n\n\n:end\npause\n'})}),"\n",(0,l.jsx)(n.h4,{id:"restartbat",children:"restart.bat"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\nif '%errorlevel%' EQU '0' (\n\tgoto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n\tgoto end\n)\n\n:main\nset basePath=%cd%\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\necho \u505c\u6b62!cMySQLName!\u670d\u52a1-----------------------------\nnet stop !cMySQLName!\necho \u542f\u52a8!cMySQLName!\u670d\u52a1-----------------------------\nnet start !cMySQLName!\n)\n\n)\n\n\n:end\npause\n"})}),"\n",(0,l.jsx)(n.h4,{id:"uninstallbat",children:"uninstall.bat"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cmd",children:"::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\nif '%errorlevel%' EQU '0' (\n\tgoto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n\tgoto end\n)\n\n:main\nset basePath=%cd%\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\necho \u505c\u6b62!cMySQLName!\u670d\u52a1-----------------------------\nnet stop !cMySQLName!\necho \u5220\u9664!cMySQLName!\u670d\u52a1-------------\nsc delete !cMySQLName!\n)\n\n)\n\n\n:end\npause\n"})}),"\n",(0,l.jsx)(n.h4,{id:"myini",children:"my.ini"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ini",children:"#auto creat\n[mysql]\ndefault-character-set=utf8\n[mysqld]\nport = 33061\nbasedir=D:\\hailaz\\mysql\\mysql1\ndatadir=D:\\hailaz\\mysql\\mysql1\\data\nsql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES\ncharacter-set-server = utf8mb4\nperformance_schema_max_table_instances = 600\ntable_definition_cache = 400\ntable_open_cache = 256\nlog-error=D:\\hailaz\\mysql\\mysql1\\log\\log-error.txt\n\nserver-id=1\ngtid-mode=on\nenforce-gtid-consistency=on\nmaster-info-repository=TABLE\nrelay-log-info-repository=TABLE\nbinlog-checksum=none\nlog-slave-updates=on\nlog-bin=binlog\nbinlog-format=ROW\n \ntransaction-write-set-extraction=XXHASH64\nloose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'\nloose-group_replication_start_on_boot=off\nloose-group_replication_local_address='localhost:33071'\nloose-group_replication_group_seeds='localhost:33071,localhost:33072,localhost:33073'\nloose-group_replication_bootstrap_group=off\nloose-group_replication_single_primary_mode=off\nloose-group_replication_enforce_update_everywhere_checks=ON\n"})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(m,{...e})}):m(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>i});var s=o(6540);const l={},a=s.createContext(l);function t(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);