"use strict";(self.webpackChunkhailaz_github_io=self.webpackChunkhailaz_github_io||[]).push([[8854],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>u});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=a.createContext({}),c=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=c(e.components);return a.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},y=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),y=c(t),u=o,d=y["".concat(i,".").concat(u)]||y[u]||p[u]||r;return t?a.createElement(d,l(l({ref:n},m),{},{components:t})):a.createElement(d,l({ref:n},m))}));function u(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=y;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,l[1]=s;for(var c=2;c<r;c++)l[c]=t[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}y.displayName="MDXCreateElement"},908:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=t(7462),o=(t(7294),t(3905));const r={layout:"post",title:"MGR",tags:["mysql"]},l=void 0,s={permalink:"/blog/2019/08/20/mgr",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2019-08-20-mgr.md",source:"@site/blog/2019-08-20-mgr.md",title:"MGR",description:"mysql\u7684\u5b89\u88c5",date:"2019-08-20T00:00:00.000Z",formattedDate:"2019\u5e748\u670820\u65e5",tags:[{label:"mysql",permalink:"/blog/tags/mysql"}],readingTime:3.435,hasTruncateMarker:!1,authors:[],frontMatter:{layout:"post",title:"MGR",tags:["mysql"]},prevItem:{title:"goset",permalink:"/blog/2019/09/05/goset"},nextItem:{title:"WebSocket",permalink:"/blog/2019/07/15/websocket"}},i={authorsImageUrls:[]},c=[{value:"mysql\u7684\u5b89\u88c5",id:"mysql\u7684\u5b89\u88c5",level:3},{value:"mysql\u914d\u7f6e\u6587\u4ef6",id:"mysql\u914d\u7f6e\u6587\u4ef6",level:3},{value:"mgr\u51c6\u5907",id:"mgr\u51c6\u5907",level:3},{value:"mgr",id:"mgr",level:3},{value:"install.bat",id:"installbat",level:4},{value:"restart.bat",id:"restartbat",level:4},{value:"uninstall.bat",id:"uninstallbat",level:4},{value:"my.ini",id:"myini",level:4}],m={toc:c};function p(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"mysql\u7684\u5b89\u88c5"},"mysql\u7684\u5b89\u88c5"),(0,o.kt)("p",null,"\u53c2\u8003\uff1a",(0,o.kt)("a",{parentName:"p",href:"https://blog.csdn.net/m0_37890289/article/details/80003994"},"windows\u540c\u65f6\u5b89\u88c5\u591a\u4e2amysql8.0\u670d\u52a1 - levenx - CSDN\u535a\u5ba2")),(0,o.kt)("p",null,"\u4e0b\u8f7dzip\u7248\u672c\u7684mysql\uff1a",(0,o.kt)("a",{parentName:"p",href:"https://dev.mysql.com/downloads/mysql/"},"MySQL :: Download MySQL Community Server")," "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cmd"},'// \u521d\u59cb\u5316\nmysqld --defaults-file=D:\\hailaz\\mysql\\mysql1\\my.ini --initialize --console\n// \u5b89\u88c5\u670d\u52a1\nmysqld install MySQL1 --defaults-file="D:\\hailaz\\mysql\\mysql1\\my.ini"\n\n// \u542f\u52a8\u670d\u52a1\nnet start MySQL1\n// \u505c\u6b62\u670d\u52a1\nnet stop MySQL1\n// \u5220\u9664\u670d\u52a1\nsc delete MySQL1\n')),(0,o.kt)("p",null,"\u4f7f\u7528install\u811a\u672c\u53ef\u4e00\u952e\u521b\u5efa\u591a\u4e2amysql\u670d\u52a1"),(0,o.kt)("h3",{id:"mysql\u914d\u7f6e\u6587\u4ef6"},"mysql\u914d\u7f6e\u6587\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ini"},"server-id=3\ngtid-mode=on\nenforce-gtid-consistency=on\nmaster-info-repository=TABLE\nrelay-log-info-repository=TABLE\nbinlog-checksum=none\nlog-slave-updates=on\nlog-bin=binlog\nbinlog-format=ROW\n \ntransaction-write-set-extraction=XXHASH64\nloose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'\nloose-group_replication_start_on_boot=off\nloose-group_replication_local_address='127.0.0.1:33071'\nloose-group_replication_group_seeds='127.0.0.1:33071,127.0.0.1:33072,127.0.0.1:33073'\nloose-group_replication_bootstrap_group=off\nloose-group_replication_single_primary_mode=off\nloose-group_replication_enforce_update_everywhere_checks=ON\n")),(0,o.kt)("h3",{id:"mgr\u51c6\u5907"},"mgr\u51c6\u5907"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-mysql"},"create user 'repl'@'%' identified with mysql_native_password by 'xiao3.top';\nGRANT REPLICATION SLAVE ON *.* TO repl@'%';\nflush privileges;\ninstall plugin group_replication soname 'group_replication.dll';\nCHANGE MASTER TO MASTER_USER='repl',MASTER_PASSWORD='xiao3.top' FOR CHANNEL 'group_replication_recovery';\n")),(0,o.kt)("h3",{id:"mgr"},"mgr"),(0,o.kt)("p",null,"\u5176\u4e2d\u4e00\u53f0"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-mysql"},"set persist group_replication_single_primary_mode=off;\nSET GLOBAL group_replication_bootstrap_group=ON;\nstart group_replication;\nSET GLOBAL group_replication_bootstrap_group=OFF; \nselect * from  performance_schema.replication_group_members;\n")),(0,o.kt)("p",null,"\u4ece\u673a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-mysql"},"set persist group_replication_single_primary_mode=off;\nSTART GROUP_REPLICATION;\nselect * from performance_schema.replication_group_members;\n")),(0,o.kt)("p",null,"\u505c\u6b62"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-mysql"},"stop GROUP_REPLICATION;\nselect * from performance_schema.replication_group_members;\n")),(0,o.kt)("p",null,"\u5931\u8d25\u65f6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-mysql"},"reset master;\nstart group_replication;\nselect * from performance_schema.replication_group_members;\n")),(0,o.kt)("h4",{id:"installbat"},"install.bat"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cmd"},'::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 "%SYSTEMROOT%\\system32\\cacls.exe" "%SYSTEMROOT%\\system32\\config\\system"\nif \'%errorlevel%\' EQU \'0\' (\n    goto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n    goto end\n)\n\n:main\nset basePath=%cd%\nset sourcePath=%basePath%\\mysql\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n\necho !cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\n\nxcopy %sourcePath% !cMySQLPath! /S /E /Y /D\n\necho \u8fdb\u5165\u76ee\u5f55!cMySQLPath!\ncd !cMySQLPath!\n\n\nif not exist !cMySQLPath!\\data (\necho data\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u521b\u5efadata\u76ee\u5f55\nmd !cMySQLPath!\\data\n)\n\nif not exist !cMySQLPath!\\log (\necho log\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u521b\u5efalog\u76ee\u5f55\nmd !cMySQLPath!\\log\n)\necho \u751f\u6210\u914d\u7f6e\u6587\u4ef6\n\necho #auto creat> my.ini\necho [mysql]>> my.ini\necho default-character-set=utf8>> my.ini\necho [mysqld]>> my.ini\necho port = 3306%%i>> my.ini\necho basedir=!cMySQLPath!>> my.ini\necho datadir=!cMySQLPath!\\data>> my.ini\necho sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES>> my.ini\necho character-set-server = utf8mb4>> my.ini\necho performance_schema_max_table_instances = 600>> my.ini\necho table_definition_cache = 400>> my.ini\necho table_open_cache = 256>> my.ini\necho log-error=!cMySQLPath!\\log\\log-error.txt>> my.ini\n\necho \u5b89\u88c5\u670d\u52a1\ncd !cMySQLPath!\\bin\nmysqld --defaults-file=!cMySQLPath!\\my.ini --initialize --console\nmysqld install !cMySQLName! --defaults-file="!cMySQLPath!\\my.ini"\n\n)\n\n)\n\n\n:end\npause\n')),(0,o.kt)("h4",{id:"restartbat"},"restart.bat"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cmd"},"::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\nif '%errorlevel%' EQU '0' (\n    goto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n    goto end\n)\n\n:main\nset basePath=%cd%\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\necho \u505c\u6b62!cMySQLName!\u670d\u52a1-----------------------------\nnet stop !cMySQLName!\necho \u542f\u52a8!cMySQLName!\u670d\u52a1-----------------------------\nnet start !cMySQLName!\n)\n\n)\n\n\n:end\npause\n")),(0,o.kt)("h4",{id:"uninstallbat"},"uninstall.bat"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cmd"},"::\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884ccmd\uff0c\u5e76\u5230\u6307\u5b9a\u76ee\u5f55\u8fd0\u884c\u3002\n@echo off\nsetlocal enabledelayedexpansion\n\n>nul 2>&1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\nif '%errorlevel%' EQU '0' (\n    goto main\n) else (\n    echo \u8bf7\u4f7f\u7528\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\n    goto end\n)\n\n:main\nset basePath=%cd%\nfor /l %%i in (1,1,5) do (\nset cMySQL=mysql%%i\nset cMySQLName=MySQL%%i\nset cMySQLPath=%basePath%\\!cMySQL!\n::\u5224\u65ad\u8def\u5f84\u662f\u5426\u5b58\u5728\nif exist !cMySQLPath! (\necho \u505c\u6b62!cMySQLName!\u670d\u52a1-----------------------------\nnet stop !cMySQLName!\necho \u5220\u9664!cMySQLName!\u670d\u52a1-------------\nsc delete !cMySQLName!\n)\n\n)\n\n\n:end\npause\n")),(0,o.kt)("h4",{id:"myini"},"my.ini"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ini"},"#auto creat\n[mysql]\ndefault-character-set=utf8\n[mysqld]\nport = 33061\nbasedir=D:\\hailaz\\mysql\\mysql1\ndatadir=D:\\hailaz\\mysql\\mysql1\\data\nsql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES\ncharacter-set-server = utf8mb4\nperformance_schema_max_table_instances = 600\ntable_definition_cache = 400\ntable_open_cache = 256\nlog-error=D:\\hailaz\\mysql\\mysql1\\log\\log-error.txt\n\nserver-id=1\ngtid-mode=on\nenforce-gtid-consistency=on\nmaster-info-repository=TABLE\nrelay-log-info-repository=TABLE\nbinlog-checksum=none\nlog-slave-updates=on\nlog-bin=binlog\nbinlog-format=ROW\n \ntransaction-write-set-extraction=XXHASH64\nloose-group_replication_group_name='ce9be252-2b71-11e6-b8f4-00212844f856'\nloose-group_replication_start_on_boot=off\nloose-group_replication_local_address='localhost:33071'\nloose-group_replication_group_seeds='localhost:33071,localhost:33072,localhost:33073'\nloose-group_replication_bootstrap_group=off\nloose-group_replication_single_primary_mode=off\nloose-group_replication_enforce_update_everywhere_checks=ON\n")))}p.isMDXComponent=!0}}]);