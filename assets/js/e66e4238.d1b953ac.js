"use strict";(self.webpackChunkhailaz_github_io=self.webpackChunkhailaz_github_io||[]).push([[4162],{2430:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"tech/network/topology","title":"\u5bb6\u5ead\u7f51\u7edc\u62d3\u6251","description":"\u7b80\u5355\u4ecb\u7ecd\u5bb6\u4e2d\u642d\u5efa\u7684\u7f51\u7edc\u60c5\u51b5","source":"@site/docs/tech/network/topology.md","sourceDirName":"tech/network","slug":"/tech/network/topology","permalink":"/docs/tech/network/topology","draft":false,"unlisted":false,"editUrl":"https://github.com/hailaz/hailaz.github.io/blob/master/docs/tech/network/topology.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"\u5bb6\u5ead\u7f51\u7edc\u62d3\u6251","sidebar_position":1},"sidebar":"tech","previous":{"title":"OpenWrt \u56fa\u4ef6","permalink":"/docs/tech/network/openwrt"},"next":{"title":"\u5c0f\u7c73AX3600 \u5f00\u542fSSH\u4e0eIPv6\u9632\u706b\u5899","permalink":"/docs/tech/network/ax3600-ssh"}}');var i=n(4848),o=n(8453);const s={title:"\u5bb6\u5ead\u7f51\u7edc\u62d3\u6251",sidebar_position:1},l=void 0,a={},c=[{value:"\u5bb6",id:"\u5bb6",level:2},{value:"\u51fa\u79df\u5c4b",id:"\u51fa\u79df\u5c4b",level:2},{value:"Windows \u9759\u6001\u8def\u7531",id:"windows-\u9759\u6001\u8def\u7531",level:2},{value:"TrueNAS zerotier \u914d\u7f6e",id:"truenas-zerotier-\u914d\u7f6e",level:2}];function d(e){const t={blockquote:"blockquote",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"\u7b80\u5355\u4ecb\u7ecd\u5bb6\u4e2d\u642d\u5efa\u7684\u7f51\u7edc\u60c5\u51b5"}),"\n",(0,i.jsx)(t.h2,{id:"\u5bb6",children:"\u5bb6"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:n(5640).A+"",width:"1161",height:"773"})}),"\n",(0,i.jsx)(t.h2,{id:"\u51fa\u79df\u5c4b",children:"\u51fa\u79df\u5c4b"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"alt text",src:n(7037).A+"",width:"1077",height:"663"})}),"\n",(0,i.jsx)(t.h2,{id:"windows-\u9759\u6001\u8def\u7531",children:"Windows \u9759\u6001\u8def\u7531"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"# \u7ba1\u7406\u5458\u547d\u4ee4\u63d0\u793a\u7b26\r\nroute -p add 192.168.30.0 mask 255.255.255.0 192.168.50.1\r\nroute -p add 192.168.192.0 mask 255.255.255.0 192.168.50.1\r\n# \u67e5\u770b\u8def\u7531\u8868\r\nroute print\n"})}),"\n",(0,i.jsx)(t.h2,{id:"truenas-zerotier-\u914d\u7f6e",children:"TrueNAS zerotier \u914d\u7f6e"}),"\n",(0,i.jsx)(t.p,{children:"\u5728 TrueNAS \u4e2d\u8bbe\u7f6e\u8f6c\u53d1"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"\u5728\u83dc\u5355 - \u7cfb\u7edf - \u9ad8\u7ea7\u914d\u7f6e - \u7cfb\u7edf\u63a7\u5236"}),"\n",(0,i.jsx)(t.p,{children:"net.ipv4.ip_forward = 1"}),"\n",(0,i.jsx)(t.p,{children:"net.ipv4.conf.all.src_valid_mark = 1"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"# \u5141\u8bb8\u4ece ztklhqrale \u5230 br0 \u7684\u8f6c\u53d1\r\niptables -I FORWARD -i ztklhqrale -o br0 -j ACCEPT\r\n\r\n# \u5141\u8bb8\u4ece br0 \u5230 ztklhqrale \u7684\u8f6c\u53d1\uff08\u56de\u7a0b\u6d41\u91cf\uff09\r\niptables -I FORWARD -i br0 -o ztklhqrale -j ACCEPT\r\n\r\n# \u6dfb\u52a0 NAT \u89c4\u5219\u4ee5\u5141\u8bb8\u6d41\u91cf\u8f6c\u53d1\r\niptables -t nat -A POSTROUTING -o br0 -s 192.168.192.0/24 -d 192.168.30.0/24 -j MASQUERADE\r\n\r\n# \u4e00\u884c\u547d\u4ee4\u5b8c\u6210\u4e0a\u8ff0\u4e09\u6b65\r\niptables -I FORWARD -i ztklhqrale -o br0 -j ACCEPT && iptables -I FORWARD -i br0 -o ztklhqrale -j ACCEPT && iptables -t nat -A POSTROUTING -o br0 -s 192.168.192.0/24 -d 192.168.30.0/24 -j MASQUERADE\r\n\r\n# \u5220\u9664\u4e0a\u8ff0\u89c4\u5219\uff08\u5982\u679c\u9700\u8981\uff09\r\niptables -D FORWARD -i ztklhqrale -o br0 -j ACCEPT\r\niptables -D FORWARD -i br0 -o ztklhqrale -j ACCEPT\r\n    \r\n# \u67e5\u770b\u5f53\u524d\u7684 FORWARD \u89c4\u5219\r\niptables -L FORWARD -v --line-numbers\r\n\r\n# \u67e5\u770b\u5f53\u524d\u7684 NAT \u89c4\u5219\r\niptables -t nat -L -v -n\n"})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},7037:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image-1-e4d644a316d55bbff9bb2d185d440851.png"},5640:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/image-ff7e481e622df86b536a5dfa4ad7a1d0.png"},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var r=n(6540);const i={},o=r.createContext(i);function s(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);